# Seasonal drought prediction for semiarid northeast Brazil: what is the added value of a process-based hydrological model?
This repository contains data and skripts to investigate and, to some extent, reproduce experiments, analyses, and figures of the Paper Pilz et al. (2019).
The paper has been published in the journal _Hydrology and Earth System Sciences_.

Reference (and link):
[Pilz, T., Delgado, J. M., Voss, S., Vormoor, K., Francke, T., Costa, A. C., Martins, E., and Bronstert, A.: Seasonal drought prediction for semiarid northeast Brazil: what is the added value of a process-based hydrological model?, Hydrol. Earth Syst. Sci., 23, 1951-1971, https://doi.org/10.5194/hess-23-1951-2019, 2019](https://www.hydrol-earth-syst-sci.net/23/1951/2019/)


# File structure
```
.
+-- _analysis
|   +-- _calibration
|   |   +-- analysis_calibration.R
|   |          R-script for regression tree analysis of WASA-SED calibration results
|   |   +-- _plots
|   |          Contains pdf files of the regression tree plots and predictor importance table, i.e. the output of the R-script
|   +-- _data
|   |      Data generated by the experiments for further analyses (see calibration/ and hindcasts/)
|   +-- _hindcasts
|   |   +-- analysis_hindcasts.R
|   |          R-script for the analysis of experiments and generation of figures (hindcast and simulation mode) of the process-based (WASA-SED) and statistical model
|   |   +-- _plots
|   |          Output (i.e. the figures presented in the paper) of the R-Script
+-- _experiments
|   +-- _hindcasts
|   |   +-- prep_res_strat_vol0.R
|   |          Creates various reservoir.dat files with varying initial conditions ("vol0") for different years, needed for hindcast and simulations runs
|   |   +-- run_hindcasts.R
|   |          Conducts WASA-SED runs in hindcast mode (with hindcasts of meteorological forcing)
|   |   +-- run_init.R
|   |          WASA-SED initialisation run (stores model states at each end of year to be used for hindcast and simulation runs)
|   |   +-- run_perfect.R
|   |          Conducts WASA-SED runs in simulation mode (with observed meteorological forcing)
|   +-- _wasa_calibration
|   |   +-- _R_code
|   |   |   +-- calib_progress.R
|   |   |          Contains function progress_calib() called in script cal_analysis.R
|   |   |   +-- function_wrapper.R
|   |   |          Contains function calib_wasa() which is a wrapper function for WASA-SED model calibration, called in script cal_subcatch.R
|   |   +-- _results
|   |          Contains, in sub-directories, log data of WASA-SED calibration runs for the individual regions (Banabuiu, Oros, Castanhao, Salgado)
|   |   +-- cal_analysis.R
|   |          Analysis of calibration runs, needs to be run for each region individually
|   |   +-- cal_subcatch.R
|   |          Calibration of the WASA-SED model, needs to be run for each region individually
|   |   +-- wasa_setups_calibrated.tar.gz
|   |          Collection of WASA-SED input files with calibrated parameters for each region of the study area
|   +-- _wasa_setup
|   |   +-- apply_lumpR.R
|   |          Initialisation of the WASA-SED model using the R-package lumpR (NOTE: script just for illustration, no raw data included due to copyright issues!)
|   |   +-- calc_subcatch.R
|   |          Extraction of sub-catchments (in the papern called regions) of the main catchment delineated and parametrised with apply_lumpR.R
```

# Workflow
Demonstration of order in which the scripts shown above need to be run.
Note that some of the scripts (mainly those in __experiments/__) cannot be readily applied as, due to copyright issues, no raw data are included in this repository.
Furthermore, scripts for pre-processing of model input data (climate, reservoirs, soil, landcover) are not included.
Neither are scripts included regarding the statistical model which was developed and runs conducted within a different project.

1. `apply_lumpR.R`: Catchment delineation and parametrisation and generation of WASA-SED input files (uncalibrated)
2. `calc_subcatch.R`: Extraction of sub-catchments (here also called regions)
3. `cal_subcatch.R`: Calibration of the WASA-SED model (each region individually)
4. `cal_analysis.R`: Quick graphical and numerical investigation of calibration results
5. `prep_res_strat_vol0.R`: Preparation of initial strategic reservoir data (extraction from observations at each begin of a year)
6. `run_init.R`: WASA-SED initialisation run (preparation of initial internal state variables for actual runs)
7. `run_perfect.R`: WASA-SED run in simulation mode (with observed meteorological forcing)
8. `run_hindcasts.R`: WASA-SED run in hindcast mode (with hindcasts of meteorological forcing)
9. `analysis_calibration.R`: Regression tree analysis of WASA-SED calibration performance
10. `analysis_hindcasts.R`: Analyses of runs of WASA-SED and a statistical model in simulation and hindcast mode
