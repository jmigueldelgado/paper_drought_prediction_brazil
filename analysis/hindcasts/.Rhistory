rename(init = value)
dat_stor_change <- dat_all %>%
# select vars
select(model, group, realis, region, year, month, value) %>%
distinct() %>%
# include observations
bind_rows(.,
dat_obs_reg %>%
filter(month %in% 1:6) %>%
select(region, year, month, value) %>%
mutate(model = "obs", group = NA, realis = NA)) %>%
# join initial values for every year = december observation of last year
complete(month = 0:6, nesting(model, group, realis, region, year))
left_join(.,
dat_obs_reg %>%
filter(month == 12) %>%
select(region, year, value, -month) %>%
mutate(year = year+1) %>%
rename(init = value),
by = c("region", "year"))
dat_stor_change <- dat_all %>%
# select vars
select(model, group, realis, region, year, month, value) %>%
distinct() %>%
# include observations
bind_rows(.,
dat_obs_reg %>%
filter(month %in% 1:6) %>%
select(region, year, month, value) %>%
mutate(model = "obs", group = NA, realis = NA)) %>%
# join initial values for every year = december observation of last year
complete(month = 0:6, nesting(model, group, realis, region, year)) %>%
left_join(.,
dat_obs_reg %>%
filter(month == 12) %>%
select(region, year, value, -month) %>%
mutate(year = year+1) %>%
rename(init = value),
by = c("region", "year"))
dat_stor_change <- dat_all %>%
# select vars
select(model, group, realis, region, year, month, value) %>%
distinct() %>%
# include observations
bind_rows(.,
dat_obs_reg %>%
filter(month %in% 1:6) %>%
select(region, year, month, value) %>%
mutate(model = "obs", group = NA, realis = NA)) %>%
# join initial values for every year = december observation of last year
complete(month = 0:6, nesting(model, group, realis, region, year)) %>%
left_join(.,
dat_obs_reg %>%
filter(month == 12) %>%
select(region, year, value, -month) %>%
mutate(year = year+1) %>%
rename(init = value),
by = c("region", "year")) %>%
mutate(value = if_else(month == 0, init, value))
dat_stor_change <- dat_all %>%
# select vars
select(model, group, realis, region, year, month, value) %>%
distinct() %>%
# include observations
bind_rows(.,
dat_obs_reg %>%
filter(month %in% 1:6) %>%
select(region, year, month, value) %>%
mutate(model = "obs", group = NA, realis = NA)) %>%
# join initial values for every year = december observation of last year
complete(month = 0:6, nesting(model, group, realis, region, year)) %>%
left_join(.,
dat_obs_reg %>%
filter(month == 12) %>%
select(region, year, value, -month) %>%
mutate(year = year+1) %>%
rename(init = value),
by = c("region", "year")) %>%
mutate(value = if_else(month == 0, init, value)) %>%
select(-init)
dat_stor_change <- dat_all %>%
# select vars
select(model, group, realis, region, year, month, value) %>%
distinct() %>%
# include observations
bind_rows(.,
dat_obs_reg %>%
filter(month %in% 1:6) %>%
select(region, year, month, value) %>%
mutate(model = "obs", group = NA, realis = NA)) %>%
# join initial values for every year = december observation of last year
complete(month = 0:6, nesting(model, group, realis, region, year)) %>%
left_join(.,
dat_obs_reg %>%
filter(month == 12) %>%
select(region, year, value, -month) %>%
mutate(year = year+1) %>%
rename(init = value),
by = c("region", "year")) %>%
mutate(value = if_else(month == 0, init, value)) %>%
select(-init) %>%
# calculate monthly change
group_by(model, group, realis, region, year)
dat_stor_change <- dat_all %>%
# select vars
select(model, group, realis, region, year, month, value) %>%
distinct() %>%
# include observations
bind_rows(.,
dat_obs_reg %>%
filter(month %in% 1:6) %>%
select(region, year, month, value) %>%
mutate(model = "obs", group = NA, realis = NA)) %>%
# join initial values for every year = december observation of last year
complete(month = 0:6, nesting(model, group, realis, region, year)) %>%
left_join(.,
dat_obs_reg %>%
filter(month == 12) %>%
select(region, year, value, -month) %>%
mutate(year = year+1) %>%
rename(init = value),
by = c("region", "year")) %>%
mutate(value = if_else(month == 0, init, value)) %>%
select(-init) %>%
# calculate monthly change
group_by(model, group, realis, region, year) %>%
mutate(value_change = c(NA,diff(value)))
?geom_boxplot
unique(dat_stor_change$group)
month(1:6)
month(1:6, abbr = T)
month(1:6, abbr = T, label = T)
month(1:6, label = T)
?month
dat_plot_t <- dat_stor_change %>%
filter(month != 0 & !grepl("biascor|resamp", group))
ggplot(dat_plot_t,
aes(x = month, y = value_change, group = interaction(group, model),
colour = model, linetype = group, shape = group)) +
geom_boxplot(data = subset(dat_plot_t, grepl("^ensemble", group)),
mapping = aes(x = month, y = value_change, group = interaction(month, model), fill = model),
inherit.aes=F, show.legend = F, outlier.colour="gray")
ggplot(dat_plot_t,
aes(x = month, y = value_change, group = interaction(group, model),
colour = model, linetype = group, shape = group)) +
geom_boxplot(data = subset(dat_plot_t, grepl("^ensemble", group)),
mapping = aes(x = month, y = value_change, group = interaction(month, model), fill = model),
inherit.aes=F, show.legend = F, outlier.colour="gray") +
geom_point(data = subset(dat_plot_t, !grepl("^ensemble", group)), size = 5) +
geom_line(data = subset(dat_plot_t, !grepl("^ensemble", group)), size = 1.2)
View(dat_plot_t)
unique(dat_plot_t$model)
unique(dat_plot_t$group)
dat_plot_t <- dat_stor_change %>%
filter(month != 0 & !grepl("biascor|resamp", group)) %>%
group_by(model, group, realis, region, month) %>%
mutate(mean_change = mean(value_change))
dat_plot_t <- dat_stor_change %>%
filter(month != 0 & !grepl("biascor|resamp", group)) %>%
group_by(model, group, realis, region, month) %>%
summarise(mean_change = mean(value_change))
dat_plot_t <- dat_stor_change %>%
filter(month != 0 & !grepl("biascor|resamp", group)) %>%
group_by(model, group, realis, region, month) %>%
summarise(mean_change = mean(value_change, na.rm = T))
ggplot(dat_plot_t,
aes(x = month, y = value_change, group = interaction(group, model),
colour = model, linetype = group, shape = group)) +
geom_boxplot(data = subset(dat_plot_t, grepl("^ensemble", group)),
mapping = aes(x = month, y = value_change, group = interaction(month, model), fill = model),
inherit.aes=F, show.legend = F, outlier.colour="gray") +
geom_point(data = subset(dat_plot_t, !grepl("^ensemble", group)), size = 5) +
geom_line(data = subset(dat_plot_t, !grepl("^ensemble", group)), size = 1.2)
ggplot(dat_plot_t,
aes(x = month, y = mean_change, group = interaction(group, model),
colour = model, linetype = group, shape = group)) +
geom_boxplot(data = subset(dat_plot_t, grepl("^ensemble", group)),
mapping = aes(x = month, y = mean_change, group = interaction(month, model), fill = model),
inherit.aes=F, show.legend = F, outlier.colour="gray") +
geom_point(data = subset(dat_plot_t, !grepl("^ensemble", group)), size = 5) +
geom_line(data = subset(dat_plot_t, !grepl("^ensemble", group)), size = 1.2)
ggplot(dat_plot_t,
aes(x = month, y = mean_change, group = interaction(group, model, realis),
colour = model, linetype = group, shape = group)) +
geom_boxplot(data = subset(dat_plot_t, grepl("^ensemble", group)),
mapping = aes(x = month, y = mean_change, group = interaction(month, model), fill = model),
inherit.aes=F, show.legend = F, outlier.colour="gray") +
geom_point(data = subset(dat_plot_t, !grepl("^ensemble", group)), size = 5) +
geom_line(data = subset(dat_plot_t, !grepl("^ensemble", group)), size = 1.2)
bla=subset(dat_plot_t, grepl("^ensemble", group))
View(bla)
ggplot(dat_plot_t,
aes(x = month, y = mean_change, group = interaction(group, model, realis),
colour = model, linetype = group, shape = group)) +
geom_boxplot(data = subset(dat_plot_t, grepl("^ensemble", group)),
mapping = aes(x = month, y = mean_change, group = interaction(month, model), fill = model),
inherit.aes=F, show.legend = F, outlier.colour="gray") +
geom_point(data = subset(dat_plot_t, !grepl("^ensemble", group)), size = 5) +
geom_line(data = subset(dat_plot_t, !grepl("^ensemble", group)), size = 1.2) +
facet_grid(region ~ .)
ggplot(dat_plot_t,
aes(x = month, y = mean_change, group = interaction(group, model),
colour = model, linetype = group, shape = group)) +
geom_boxplot(data = subset(dat_plot_t, grepl("^ensemble", group)),
mapping = aes(x = month, y = mean_change, group = interaction(month, model), fill = model),
inherit.aes=F, show.legend = F, outlier.colour="gray") +
geom_point(data = subset(dat_plot_t, !grepl("^ensemble", group)), size = 5) +
geom_line(data = subset(dat_plot_t, !grepl("^ensemble", group)), size = 1.2) +
facet_grid(region ~ .)
dat_stor_change <- dat_all %>%
# select vars
select(model, group, realis, region, year, month, value) %>%
distinct() %>%
# include observations
bind_rows(.,
dat_obs_reg %>%
filter(month %in% 1:6) %>%
select(region, year, month, value) %>%
mutate(model = "obs", group = "obs", realis = NA)) %>%
# join initial values for every year = december observation of last year
complete(month = 0:6, nesting(model, group, realis, region, year)) %>%
left_join(.,
dat_obs_reg %>%
filter(month == 12) %>%
select(region, year, value, -month) %>%
mutate(year = year+1) %>%
rename(init = value),
by = c("region", "year")) %>%
mutate(value = if_else(month == 0, init, value)) %>%
select(-init) %>%
# calculate monthly change
group_by(model, group, realis, region, year) %>%
mutate(value_change = c(NA,diff(value)))
View(dat_stor_change)
dat_plot_t <- dat_stor_change %>%
filter(month != 0 & !grepl("biascor|resamp", group)) %>%
group_by(model, group, realis, region, month) %>%
summarise(mean_change = mean(value_change, na.rm = T))
ggplot(dat_plot_t,
aes(x = month, y = mean_change, group = interaction(group, model),
colour = model, linetype = group, shape = group)) +
geom_boxplot(data = subset(dat_plot_t, grepl("^ensemble", group)),
mapping = aes(x = month, y = mean_change, group = interaction(month, model), fill = model),
inherit.aes=F, show.legend = F, outlier.colour="gray") +
geom_point(data = subset(dat_plot_t, !grepl("^ensemble", group)), size = 5) +
geom_line(data = subset(dat_plot_t, !grepl("^ensemble", group)), size = 1.2) +
facet_grid(region ~ .)
ggplot(dat_plot_t,
aes(x = month, y = mean_change, group = interaction(group, model),
colour = model, linetype = group, shape = group)) +
geom_boxplot(data = subset(dat_plot_t, grepl("^ensemble", group)),
mapping = aes(x = month, y = mean_change, group = interaction(month, model), fill = model),
inherit.aes=F, show.legend = F, outlier.colour="gray") +
geom_point(data = subset(dat_plot_t, !grepl("^ensemble", group)), size = 5) +
geom_line(data = subset(dat_plot_t, !grepl("^ensemble", group)), size = 1.2) +
facet_grid(region ~ .)
ggplot(dat_plot_t,
aes(x = month, y = mean_change, group = interaction(group, model),
colour = model, linetype = group, shape = group)) +
geom_boxplot(data = subset(dat_plot_t, grepl("^ensemble", group)),
mapping = aes(x = month, y = mean_change, group = interaction(month, model), fill = model),
inherit.aes=F, show.legend = F, outlier.colour="gray") +
geom_point(data = subset(dat_plot_t, !grepl("^ensemble", group)), size = 5) +
geom_line(data = subset(dat_plot_t, !grepl("^ensemble", group)), size = 1.2) +
facet_grid(region ~ .) +
theme_bw(base_size = 22) +
theme(legend.key.width = unit(50, "pt"))
dat_plot_t <- dat_stor_change %>%
filter(month != 0 & !grepl("biascor|resamp", group)) %>%
group_by(model, group, realis, month) %>%
summarise(mean_change = mean(value_change, na.rm = T))
ggplot(dat_plot_t,
aes(x = month, y = mean_change, group = interaction(group, model),
colour = model, linetype = group, shape = group)) +
geom_boxplot(data = subset(dat_plot_t, grepl("^ensemble", group)),
mapping = aes(x = month, y = mean_change, group = interaction(month, model), fill = model),
inherit.aes=F, show.legend = F, outlier.colour="gray") +
geom_point(data = subset(dat_plot_t, !grepl("^ensemble", group)), size = 5) +
geom_line(data = subset(dat_plot_t, !grepl("^ensemble", group)), size = 1.2) +
#facet_grid(region ~ .) +
theme_bw(base_size = 22) +
theme(legend.key.width = unit(50, "pt"))
dat_plot_t <- dat_stor_change %>%
filter(month != 0 & !grepl("biascor|resamp|median", group)) %>%
group_by(model, group, realis, month) %>%
summarise(mean_change = mean(value_change, na.rm = T))
ggplot(dat_plot_t,
aes(x = month, y = mean_change, group = interaction(group, model),
colour = model, linetype = group, shape = group)) +
geom_boxplot(data = subset(dat_plot_t, grepl("^ensemble", group)),
mapping = aes(x = month, y = mean_change, group = interaction(month, model), fill = model),
inherit.aes=F, show.legend = F, outlier.colour="gray") +
geom_point(data = subset(dat_plot_t, !grepl("^ensemble", group)), size = 5) +
geom_line(data = subset(dat_plot_t, !grepl("^ensemble", group)), size = 1.2) +
#facet_grid(region ~ .) +
theme_bw(base_size = 22) +
theme(legend.key.width = unit(50, "pt"))
dat_plot_t <- dat_stor_change %>%
filter(month != 0 & !grepl("biascor|resamp|median", group)) %>%
group_by(model, group, realis, month) %>%
summarise(mean_change = mean(value_change, na.rm = T)) %>%
mutate(locale = "en_GB.UTF-8")
ggplot(dat_plot_t,
aes(x = month, y = mean_change, group = interaction(group, model),
colour = model, linetype = group, shape = group)) +
geom_boxplot(data = subset(dat_plot_t, grepl("^ensemble", group)),
mapping = aes(x = month, y = mean_change, group = interaction(month, model), fill = model),
inherit.aes=F, show.legend = F, outlier.colour="gray") +
geom_point(data = subset(dat_plot_t, !grepl("^ensemble", group)), size = 5) +
geom_line(data = subset(dat_plot_t, !grepl("^ensemble", group)), size = 1.2) +
labs(x = "Aggregation month", y = "RMSE (percent point)", colour = "Model: ", linetype = "Mode: ", shape = "Mode: ") +
theme_bw(base_size = 22) +
theme(legend.key.width = unit(50, "pt"))
dat_plot_t <- dat_stor_change %>%
filter(month != 0 & !grepl("biascor|resamp|median", group)) %>%
group_by(model, group, realis, month) %>%
summarise(mean_change = mean(value_change, na.rm = T)) %>%
mutate(month = month(month, locale = "en_GB.UTF-8"))
ggplot(dat_plot_t,
aes(x = month, y = mean_change, group = interaction(group, model),
colour = model, linetype = group, shape = group)) +
geom_boxplot(data = subset(dat_plot_t, grepl("^ensemble", group)),
mapping = aes(x = month, y = mean_change, group = interaction(month, model), fill = model),
inherit.aes=F, show.legend = F, outlier.colour="gray") +
geom_point(data = subset(dat_plot_t, !grepl("^ensemble", group)), size = 5) +
geom_line(data = subset(dat_plot_t, !grepl("^ensemble", group)), size = 1.2) +
labs(x = "Aggregation month", y = "RMSE (percent point)", colour = "Model: ", linetype = "Mode: ", shape = "Mode: ") +
theme_bw(base_size = 22) +
theme(legend.key.width = unit(50, "pt"))
View(dat_plot_t)
?month
dat_plot_t <- dat_stor_change %>%
filter(month != 0 & !grepl("biascor|resamp|median", group)) %>%
group_by(model, group, realis, month) %>%
summarise(mean_change = mean(value_change, na.rm = T)) %>%
mutate(month = month(month, label = T, locale = "en_GB.UTF-8"))
ggplot(dat_plot_t,
aes(x = month, y = mean_change, group = interaction(group, model),
colour = model, linetype = group, shape = group)) +
geom_boxplot(data = subset(dat_plot_t, grepl("^ensemble", group)),
mapping = aes(x = month, y = mean_change, group = interaction(month, model), fill = model),
inherit.aes=F, show.legend = F, outlier.colour="gray") +
geom_point(data = subset(dat_plot_t, !grepl("^ensemble", group)), size = 5) +
geom_line(data = subset(dat_plot_t, !grepl("^ensemble", group)), size = 1.2) +
labs(x = "Aggregation month", y = "RMSE (percent point)", colour = "Model: ", linetype = "Mode: ", shape = "Mode: ") +
theme_bw(base_size = 22) +
theme(legend.key.width = unit(50, "pt"))
ggplot(dat_plot_t,
aes(x = month, y = mean_change, group = interaction(group, model),
colour = model, linetype = group, shape = group)) +
geom_boxplot(data = subset(dat_plot_t, grepl("^ensemble", group)),
mapping = aes(x = month, y = mean_change, group = interaction(month, model), fill = model),
inherit.aes=F, show.legend = F, outlier.colour="gray") +
geom_point(data = subset(dat_plot_t, !grepl("^ensemble", group)), size = 5) +
geom_line(data = subset(dat_plot_t, !grepl("^ensemble", group)), size = 1.2) +
labs(x = "Aggregation month", y = "Regional storage change (percent point)", colour = "Model: ", linetype = "Mode: ", shape = "Mode: ") +
theme_bw(base_size = 22) +
theme(legend.key.width = unit(50, "pt"))
unique(dat_plot_t$group)
dat_plot_t <- dat_stor_change %>%
filter(month != 0 & !grepl("biascor|resamp|median", group)) %>%
group_by(model, group, realis, month) %>%
summarise(mean_change = mean(value_change, na.rm = T)) %>%
mutate(month = month(month, label = T, locale = "en_GB.UTF-8")) %>%
ungroup() %>%
mutate(model = factor(model, c("hydmod", "regression"), labels = c("Process-based", "Statistical")),
group = factor(group, c("ensemble", "perfect", "obs"), labels = c("ensemble", "Simulation mode results", "Observations")))
ggplot(dat_plot_t,
aes(x = month, y = mean_change, group = interaction(group, model),
colour = model, linetype = group, shape = group)) +
geom_boxplot(data = subset(dat_plot_t, grepl("^ensemble", group)),
mapping = aes(x = month, y = mean_change, group = interaction(month, model), fill = model),
inherit.aes=F, show.legend = F, outlier.colour="gray") +
geom_point(data = subset(dat_plot_t, !grepl("^ensemble", group)), size = 5) +
geom_line(data = subset(dat_plot_t, !grepl("^ensemble", group)), size = 1.2) +
labs(x = "Aggregation month", y = "Regional storage change (percent point)", colour = "Model: ", linetype = "Mode: ", shape = "Mode: ") +
theme_bw(base_size = 22) +
theme(legend.key.width = unit(50, "pt"))
dat_plot_t <- dat_stor_change %>%
filter(month != 0 & !grepl("biascor|resamp|median", group)) %>%
group_by(model, group, realis, month) %>%
summarise(mean_change = mean(value_change, na.rm = T)) %>%
mutate(month = month(month, label = T, locale = "en_GB.UTF-8")) %>%
ungroup() %>%
mutate(model = factor(model, c("hydmod", "regression", "obs"), labels = c("Process-based model", "Statistical model", "Observations")),
group = factor(group, c("ensemble", "perfect", "obs"), labels = c("ensemble", "Simulation mode results", "Observations")))
ggplot(dat_plot_t,
aes(x = month, y = mean_change, group = interaction(group, model),
colour = model, linetype = group, shape = group)) +
geom_boxplot(data = subset(dat_plot_t, grepl("^ensemble", group)),
mapping = aes(x = month, y = mean_change, group = interaction(month, model), fill = model),
inherit.aes=F, show.legend = F, outlier.colour="gray") +
geom_point(data = subset(dat_plot_t, !grepl("^ensemble", group)), size = 5) +
geom_line(data = subset(dat_plot_t, !grepl("^ensemble", group)), size = 1.2) +
labs(x = "Aggregation month", y = "Regional storage change (percent point)", colour = "Model: ", linetype = "Mode: ", shape = "Mode: ") +
theme_bw(base_size = 22) +
theme(legend.key.width = unit(50, "pt"))
ggplot(dat_plot_t,
aes(x = month, y = mean_change, group = interaction(group, model),
colour = model, linetype = group, shape = group)) +
geom_boxplot(data = subset(dat_plot_t, grepl("^ensemble", group)),
mapping = aes(x = month, y = mean_change, group = interaction(month, model), fill = model),
inherit.aes=F, show.legend = F, outlier.colour="gray") +
geom_point(data = subset(dat_plot_t, !grepl("^ensemble", group)), size = 5) +
geom_line(data = subset(dat_plot_t, !grepl("^ensemble", group)), size = 1.2) +
lims(y = c(-5,20)) +
labs(x = "Aggregation month", y = "Regional storage change (percent point)",
colour = "Data: ", linetype = "Mode: ", shape = "Mode: ") +
theme_bw(base_size = 22) +
theme(legend.key.width = unit(50, "pt"))
ggplot(dat_plot_t,
aes(x = month, y = mean_change, group = interaction(group, model),
colour = model, linetype = group, shape = group)) +
geom_boxplot(data = subset(dat_plot_t, grepl("^ensemble", group)),
mapping = aes(x = month, y = mean_change, group = interaction(month, model), fill = model),
inherit.aes=F, show.legend = T, outlier.colour="gray") +
geom_point(data = subset(dat_plot_t, !grepl("^ensemble", group)), size = 5) +
geom_line(data = subset(dat_plot_t, !grepl("^ensemble", group)), size = 1.2) +
lims(y = c(-5,20)) +
labs(x = "Aggregation month", y = "Regional storage change (percent point)",
colour = "Data: ", linetype = "Mode: ", shape = "Mode: ") +
theme_bw(base_size = 22) +
theme(legend.key.width = unit(50, "pt"))
dat_plot_t <- dat_stor_change %>%
filter(month != 0 & !grepl("biascor|resamp|^ensemble", group)) %>%
group_by(model, group, realis, month) %>%
summarise(mean_change = mean(value_change, na.rm = T)) %>%
mutate(month = month(month, label = T, locale = "en_GB.UTF-8")) %>%
ungroup() %>%
mutate(model = factor(model, c("hydmod", "regression", "obs"), labels = c("Process-based model", "Statistical model", "Observations")),
group = factor(group, c("median_ensemble", "perfect", "obs"), labels = c("Median", "Simulation mode results", "Observations")))
dat_plot_t <- dat_stor_change %>%
filter(month != 0 & !grepl("biascor|resamp|^ensemble", group)) %>%
group_by(model, group, realis, month) %>%
summarise(mean_change = mean(value_change, na.rm = T)) %>%
mutate(month = month(month, label = T, locale = "en_GB.UTF-8")) %>%
ungroup() %>%
mutate(model = factor(model, c("hydmod", "regression", "obs"), labels = c("Process-based model", "Statistical model", "Observations")),
group = factor(group, c("median_ensemble", "perfect", "obs"), labels = c("Ensemble median", "Simulation mode results", "Observations")))
dat_plot_t <- dat_stor_change %>%
filter(month != 0 & !grepl("biascor|resamp|^ensemble", group)) %>%
group_by(model, group, realis, month) %>%
summarise(mean_change = mean(value_change, na.rm = T)) %>%
mutate(month = month(month, label = T, locale = "en_GB.UTF-8")) %>%
ungroup() %>%
mutate(model = factor(model, c("hydmod", "regression", "obs"), labels = c("Process-based model", "Statistical model", "Observations")),
group = factor(group, c("median_ensemble", "perfect", "obs"), labels = c("Hindcast mode results", "Simulation mode results", "Observations")))
ggplot(dat_plot_t,
aes(x = month, y = mean_change, group = interaction(group, model),
colour = model, linetype = group, shape = group)) +
# geom_boxplot(data = subset(dat_plot_t, grepl("^ensemble", group)),
#              mapping = aes(x = month, y = mean_change, group = interaction(month, model), fill = model),
#              inherit.aes=F, show.legend = T, outlier.colour="gray") +
# geom_point(data = subset(dat_plot_t, !grepl("^ensemble", group)), size = 5) +
# geom_line(data = subset(dat_plot_t, !grepl("^ensemble", group)), size = 1.2) +
geom_point(size = 5) +
geom_line(size = 1.2) +
lims(y = c(-5,20)) +
labs(x = "Aggregation month", y = "Regional storage change (percent point)",
colour = "Data: ", linetype = "Mode: ", shape = "Mode: ") +
theme_bw(base_size = 22) +
theme(legend.key.width = unit(50, "pt"))
ggplot(dat_plot_t,
aes(x = month, y = mean_change, group = interaction(group, model),
colour = model, linetype = group, shape = group)) +
geom_point(size = 5) +
geom_line(size = 1.2) +
lims(y = c(-5,20)) +
labs(x = "Aggregation month", y = "Regional storage change (percent point)",
colour = "Data: ", linetype = "Mode: ", shape = "Mode: ") +
theme_bw(base_size = 22) +
theme(legend.key.width = unit(50, "pt"))
ggplot(dat_plot_t,
aes(x = month, y = mean_change, group = interaction(group, model),
colour = model, linetype = group, shape = group)) +
geom_point(size = 5) +
geom_line(size = 1.2) +
lims(y = c(-5,20)) +
labs(x = "Aggregation month", y = "Regional storage change (percent point)",
colour = "Data: ", linetype = "Mode: ", shape = "Mode: ") +
theme_bw(base_size = 22) +
theme(legend.key.width = unit(50, "pt"))
dat_plot_t <- dat_stor_change %>%
filter(month != 0 & !grepl("biascor|resamp|^ensemble", group)) %>%
group_by(model, group, realis, month) %>%
summarise(mean_change = mean(value_change, na.rm = T)) %>%
mutate(month = month(month, label = T, locale = "en_GB.UTF-8")) %>%
ungroup() %>%
mutate(model = factor(model, c("hydmod", "regression", "obs"), labels = c("Process-based model", "Statistical model", "Observations")),
group = factor(group, c("median_ensemble", "perfect", "obs"), labels = c("Hindcast", "Simulation", "Observation")))
ggplot(dat_plot_t,
aes(x = month, y = mean_change, group = interaction(group, model),
colour = model, linetype = group, shape = group)) +
geom_point(size = 5) +
geom_line(size = 1.2) +
lims(y = c(-5,20)) +
labs(x = "Aggregation month", y = "Regional storage change (percent point)",
colour = "Data: ", linetype = "Mode: ", shape = "Mode: ") +
theme_bw(base_size = 22) +
theme(legend.key.width = unit(50, "pt"))
file_out_storage_change <- "plots/storage_changes.pdf"
gp <- ggplot(dat_plot_t,
aes(x = month, y = mean_change, group = interaction(group, model),
colour = model, linetype = group, shape = group)) +
geom_point(size = 5) +
geom_line(size = 1.2) +
lims(y = c(-5,20)) +
labs(x = "Aggregation month", y = "Regional storage change (percent point)",
colour = "Data: ", linetype = "Mode: ", shape = "Mode: ") +
theme_bw(base_size = 22) +
theme(legend.key.width = unit(50, "pt"))
ggsave(file_out_storage_change, height = 8, width = 18)
